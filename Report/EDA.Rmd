---
title: "DA_Project"
author: "Nina"
date: "4/20/2022"
output: html_document
---

```{r, echo = FALSE, message = FALSE}
source(here::here("Scripts/SetUp.R"))
```

### EDA


# Response attribute transformation
 
```{r }
n <- dim(bands3_reduced)[1]
p <- dim(bands3_reduced)[2]
```
n = ROW = 540 observartions 
p = COLUMN = 29 variables/characteristics

## Data structure and summary
 
```{r }
str(bands3_reduced)
head(bands3_reduced)
summary(bands3_reduced)
describe(bands3_reduced)
as_tibble(bands3_reduced)
datatable(bands3_reduced)
```

```{r }
dfSummary(bands3_reduced, style = "grid")
```

# DataExpolrer library

```{r }
introduce(bands3_reduced)
plot_intro(bands3_reduced)
```

# Missing observations
```{r }
nrows <- nrow(bands3_reduced)
n.missing <- rowSums(is.na(bands3_reduced))
sum(n.missing > 0)/nrows
```

```{r }
n.complete <- sum(complete.cases(bands3_reduced))
n.complete/nrows
```

```{r }
plot_missing(bands3_reduced)
```

# 1. We plot the numerical variables: 

```{r }
plot_histogram(bands3_reduced)
```

```{r }
plot_density(bands3_reduced,
             ggtheme = theme_bw()) # Density plots
```

```{r}
plot_boxplot(bands3_reduced, by = 'band_type',  ncol = 2,
             title = "Side-by-side boxplots") # Boxplot

```


# 2. We plot the categorical variables: 

```{r}
bands3_reduced %>%
  keep(is.character) %>%
  gather() %>%
  ggplot(aes(value)) +
  facet_wrap(~ key, scales = "free") +
  geom_bar(stat="count") +
  coord_flip()
```

```{r}
ggplot(bands3_reduced) +
  geom_bar(aes(x = cylinder_size))
```
--> changer la variable du x pour faire apparaitre un autre graphique mais meme chose aue graphique précédent. 


# e. Variables summaries of quantitative variables 
```{r }
quali <- c(29,1:11)
quanti<-12:28
mat<-matrix(0, length(quanti), 7)
colnames(mat)<-c("Min.", "1st Qu.", "Median", "Mean", "Sd", "3rd Qu.", "Max.")
rownames(mat)<-names(bands3_reduced)[quanti]
mat[,1]<-apply(bands3_reduced[,quanti], 2, min, na.rm=TRUE)
mat[,2]<-apply(bands3_reduced[,quanti], 2, quantile, 0.25, na.rm=TRUE)
mat[,3]<-apply(bands3_reduced[,quanti], 2, median, na.rm=TRUE)
mat[,4]<-apply(bands3_reduced[,quanti], 2, mean, na.rm=TRUE)
mat[,5]<-apply(bands3_reduced[,quanti], 2, sd, na.rm=TRUE)
mat[,6]<-apply(bands3_reduced[,quanti], 2, quantile, 0.75, na.rm=TRUE)
mat[,7]<-apply(bands3_reduced[,quanti], 2, max, na.rm=TRUE)
print(round(mat, 2))
```


# f. Pairwise comparison

Only quantitative variables: 
```{r}
bands3_reduced.quant<-bands3_reduced[,quanti]
```
Correlation plot between quantitative variables :(faut-il séparer variables continues et discretes ?? )
```{r}
plot_correlation(bands3_reduced.quant, type= 'c', cor_args = list( 'use' = 'complete.obs'))
```
No correlation, independant variables except 'ink_pct' & 'varnish_pct' (nagatively correlated) . 

```{r}
pairs(bands3_reduced.quant)
```

```{r }
pairs.panels(bands3_reduced.quant)
```

```{r}
ggpairs(bands3_reduced.quant)
```

```{r }
#ggpairs(bands3_reduced, ggplot2::aes(colour=band_type))
```
--> trop long a run et pas sur que ca marche, rien ne s'affiche mais pas vraiment utile je crois 

```{r }
#cor(bands3_reduced.quant)
```
--> sort que des NA mais inutile car meme chose que le plot_correlation plus haut 

```{r }
#corrplot(cor(bands3_reduced.quant))
```
--> juste une autre facon de montrer les correlations 

```{r }
d<-correlate(bands3_reduced.quant)         
#d %>%
#+   shave() %>% # Remove the upper triangle
#+   fashion()
```


```{r }
d %>% network_plot(min_cor=.1)
```


```{r }
#corrplot.mixed(cor(bands3_reduced.quant), order="hclust", #tl.col="black")
```
--> encore un autre corrplot

```{r }
#ggcorrplot(cor(bands3.quant), p.mat=cor_pmat(bands3[,quanti]), #hc.order=TRUE, type='lower')
```
--> un autre, en soit on peut garder seulement le premier corrplot


## 2.2 Inspected library

```{r }
x<-inspect_types(bands3_reduced)
show_plot(x, col_palette=2)
```
We have 17 numerical variables and 11 character. 

```{r}
x<-inspect_na(bands3_reduced)
show_plot(x, col_palette=5)
```

```{r}
x<-inspect_num(bands3_reduced)
show_plot(x, col_palette=3)
```

```{r}
x<-inspect_cat(bands3_reduced) 
show_plot(x)
```

```{r}
x<-inspect_cor(bands3_reduced)
show_plot(x, col_palette=4)
```

## 2.3 Outliers
 







